export type LocaleKey = 'de' | 'en';

export const SUPPORTED_LOCALES: readonly LocaleKey[] = ['de', 'en'];
export const DEFAULT_LOCALE: LocaleKey = 'de';

const translations: Record<LocaleKey, Record<string, string>> = {
  de: {
    'app.title': 'CannaClicker',
    'stats.buds': 'Buds',
    'stats.bpc': 'Buds pro Klick',
    'stats.bps': 'Buds pro Sekunde',
    'stats.total': 'Gesamt geerntet',
    'stats.seeds': 'Seeds',
    'stats.prestigeMult': 'Prestige-Multiplikator',
    'actions.click': 'Ernte Buds',
    'actions.buy': 'Kaufen',
    'actions.max': 'Max',
    'actions.export': 'Export',
    'actions.import': 'Import',
    'actions.reset': 'Reset',
    'actions.close': 'Schließen',
    'actions.mute': 'Stumm',
    'actions.unmute': 'Ton',
    'actions.prestige': 'Prestige',
    'actions.confirm': 'Bestätigen',
    'actions.cancel': 'Abbrechen',
    'modal.import.title': 'Spielstand importieren',
    'modal.import.hint': 'Füge hier deinen Base64-Export ein.',
    'modal.reset.title': 'Fortschritt zurücksetzen?',
    'modal.reset.body': 'Das löscht deinen aktuellen Fortschritt unwiderruflich.',
    'modal.reset.confirm': 'Ja, löschen',
    'panel.tabs.shop': 'Anbau',
    'panel.tabs.upgrades': 'Upgrades',
    'panel.tabs.research': 'Forschung',
    'panel.tabs.prestige': 'Prestige',
    'panel.tabs.achievements': 'Erfolge',
    'panel.prestige.description': 'Verdiene Seeds und steigere deinen globalen Bonus durch Prestige.',
    'panel.prestige.requirement': 'Benötigt {value} Lifetime-Buds',
    'panel.prestige.tooSoon': 'Noch keine zusätzlichen Seeds verfügbar.',
    'panel.prestige.ready': 'Bereit für Prestige!',
    'shop.title': 'Anbau',
    'shop.empty': 'Noch keine Gebaeude verfuegbar. Ernte mehr Buds!',
    'shop.cost': 'Kosten',
    'shop.owned': 'Besitzt',
    'shop.roiValue': 'ROI {seconds}s',
    'shop.roiInfinite': 'ROI ∞',
    'shop.stageLabel': 'Stufe {level}',
    'shop.stageProgress': 'noch {remaining} bis Stufe {next}',
    'shop.stageTooltip': 'Stufenbonus ×{bonus} je {count} Käufe',
    'shop.softcapBadge': '↓SC ×{stacks}',
    'shop.softcapTooltipNext': 'Basisproduktion -{percent}%. Nächste Reduktion bei {next}.',
    'shop.softcapTooltipMax': 'Basisproduktion -{percent}%. Keine weiteren Reduktionen.',
    'upgrades.title': 'Upgrades',
    'upgrades.cost': 'Kosten',
    'upgrades.action.buy': 'Upgrade',
    'upgrades.status.owned': 'Gekauft',
    'upgrades.status.ready': 'Freigeschaltet',
    'upgrades.status.affordable': 'Kaufbereit',
    'upgrades.status.locked': 'Gesperrt',
    'upgrades.progress.active': 'Aktiv',
    'upgrades.lock.items': 'Noch {remaining}× {name}',
    'upgrades.lock.total': 'Noch {amount} Lifetime-Buds',
    'upgrades.lock.upgrade': 'Vorheriges Upgrade erforderlich: {name}',
    'upgrades.requirement.items': '{current}/{required}× {name}',
    'upgrades.requirement.total': 'Lifetime-Buds {current} / {required}',
    'upgrades.requirement.upgrade': 'Benötigt Upgrade: {name}',
    'upgrades.category.building': 'Gebäude',
    'upgrades.category.synergy': 'Synergie',
    'upgrades.category.utility': 'Support',
    'upgrades.toast.title': 'Upgrade',
    'upgrades.toast.message': '{name} verbessert!',
    'upgrades.fx.spark': 'Upgrade!',
    'achievements.title': 'Erfolge',
    'achievements.reward': 'Bonus +{value}%',
    'achievements.status.locked': 'Nicht erreicht',
    'achievements.status.unlocked': 'Freigeschaltet',
    'abilities.title': 'Aktive Faehigkeiten',
    'abilities.status.ready': 'Bereit',
    'abilities.status.active': 'Aktiv ({seconds}s)',
    'abilities.status.cooldown': 'Abklingzeit ({seconds}s)',
    'abilities.overdrive.name': 'Overdrive',
    'abilities.overdrive.desc': 'Produktion x{multiplier} fuer {duration} s. Abklingzeit {cooldown} s.',
    'abilities.burst.name': 'Burst Click',
    'abilities.burst.desc': 'Klickwert x{multiplier} fuer {duration} s. Abklingzeit {cooldown} s.',
    'research.title': 'Forschung',
    'research.filter.all': 'Alle',
    'research.filter.available': 'Verfuegbar',
    'research.filter.owned': 'Gekauft',
    'research.path.efficiency': 'Pfad A · Effizienz',
    'research.path.control': 'Pfad B · Kontrolle',
    'research.path.strain': 'Pfad C · Strains',
    'research.cost.buds': 'Kosten (Buds)',
    'research.cost.seeds': 'Kosten (Seeds)',
    'research.requires': 'Benoetigt: {list}',
    'research.button.buy': 'Erforschen',
    'research.button.owned': 'Abgeschlossen',
    'research.button.locked': 'Gesperrt',
    'research.empty': 'Keine Forschung verfuegbar.',
    'research.effect.bps': 'BPS x{value}',
    'research.effect.bpc': 'BPC x{value}',
    'research.effect.cost': 'Kosten -{value}%',
    'research.effect.autoclick': 'Auto-Klick +{value}/s',
    'research.effect.overdrive': 'Overdrive +{value}%',
    'research.effect.offline': 'Offline-Cap +{value}h',
    'research.effect.abilityDuration': 'Skill-Dauer +{value}%',
    'research.effect.hydroIrrigation': 'Hydro & Bewaesserung x{value}',
    'research.effect.hybridBuff': '+{percent}% je aktivem Buff',
    'research.effect.strain.indica': 'Spezialisierung: Indica',
    'research.effect.strain.sativa': 'Spezialisierung: Sativa',
    'research.effect.strain.hybrid': 'Spezialisierung: Hybrid',
    'research.confirm.strain': 'Diese Strain-Wahl gilt bis zum naechsten Prestige. Jetzt aktivieren?',
    'research.lock.exclusive': 'Andere Spezialisierung bereits aktiv. Wechsel erst nach Prestige.',
    'research.lock.totalBuds': 'Erfordert Gesamtbuds ≥ {value}',
    'research.lock.prestigeSeeds': 'Erfordert Seeds ≥ {value} (aktuell {current})',
    'research.lock.all': 'Benoetigt: {list}',
    'research.lock.any': 'Erfuellt eine der folgenden Bedingungen: {list}',
    'prestige.modal.title': 'Prestige starten?',
    'prestige.modal.description': 'Soft-Reset loescht Buds, Gebaeude und Upgrades, Seeds bleiben erhalten.',
    'prestige.modal.warning': 'Setzt Buds, Items und Faehigkeiten zurueck. Seeds bleiben erhalten.',
    'prestige.modal.currentSeeds': 'Aktuelle Seeds',
    'prestige.modal.afterSeeds': 'Seeds nach Prestige',
    'prestige.modal.gainSeeds': 'Seeds heute',
    'prestige.modal.globalBonus': 'Neuer Global-Bonus',
    'prestige.modal.requirement': 'Benoetigt {value} Lifetime-Buds',
    'prestige.modal.tooSoon': 'Zu wenige Buds fuer neue Seeds',
    'prestige.modal.checkbox': 'Ich verstehe den Soft-Reset',
    'prestige.modal.confirm': 'Prestige ausloesen',
    'prestige.badge.tooltip': 'Globaler Bonus: +{value}%',
    'prestige.control.locked': 'Prestige ab {requirement} Lifetime-Buds',
    'toast.offline.title': 'Offline-Ertrag',
    'toast.offline.body': '+{buds} Buds fuer {duration}',
    'events.goldenBud.name': 'Goldener Bud',
    'events.goldenBud.title': 'Golden Bud',
    'events.goldenBud.body': 'Sofort +{buds} Buds eingesackt!',
    'events.seedPack.name': 'Seed Pack',
    'events.seedPack.title': 'Seed Pack',
    'events.seedPack.body': '+{seeds} Seeds eingesammelt!',
    'events.luckyJoint.name': 'Lucky Joint',
    'events.luckyJoint.title': 'Lucky Joint',
    'events.luckyJoint.body': 'Produktion x{multiplier} für {duration}s!',
    'events.luckyJoint.refresh': 'Boost erneuert! Produktion x{multiplier} für {duration}s.',
    'toggle.on': 'AN',
    'toggle.off': 'AUS',
  },
  en: {
    'app.title': 'CannaClicker',
    'stats.buds': 'Buds',
    'stats.bpc': 'Buds per Click',
    'stats.bps': 'Buds per Second',
    'stats.total': 'Total Harvested',
    'stats.seeds': 'Seeds',
    'stats.prestigeMult': 'Prestige Multiplier',
    'actions.click': 'Harvest Buds',
    'actions.buy': 'Buy',
    'actions.max': 'Max',
    'actions.export': 'Export',
    'actions.import': 'Import',
    'actions.reset': 'Reset',
    'actions.close': 'Close',
    'actions.mute': 'Mute',
    'actions.unmute': 'Sound',
    'actions.prestige': 'Prestige',
    'actions.confirm': 'Confirm',
    'actions.cancel': 'Cancel',
    'modal.import.title': 'Import save',
    'modal.import.hint': 'Paste your Base64 save code here.',
    'modal.reset.title': 'Reset progress?',
    'modal.reset.body': 'This cannot be undone and clears your current game.',
    'modal.reset.confirm': 'Yes, delete it',
    'panel.tabs.shop': 'Grow Ops',
    'panel.tabs.upgrades': 'Upgrades',
    'panel.tabs.research': 'Research',
    'panel.tabs.prestige': 'Prestige',
    'panel.tabs.achievements': 'Achievements',
    'panel.prestige.description': 'Prestige to earn seeds and unlock global bonuses.',
    'panel.prestige.requirement': 'Requires {value} lifetime buds',
    'panel.prestige.tooSoon': 'No new seeds available yet.',
    'panel.prestige.ready': 'Ready for prestige!',
    'prestige.modal.gainSeeds': 'Seeds Today',
    'prestige.modal.globalBonus': 'New Global Bonus',
    'shop.title': 'Grow Ops',
    'shop.empty': 'No buildings unlocked yet. Harvest more buds!',
    'shop.cost': 'Cost',
    'shop.owned': 'Owned',
    'shop.roiValue': 'ROI {seconds}s',
    'shop.roiInfinite': 'ROI ∞',
    'shop.stageLabel': 'Stage {level}',
    'shop.stageProgress': '{remaining} until Stage {next}',
    'shop.stageTooltip': 'Tier bonus ×{bonus} per {count} purchases',
    'shop.softcapBadge': '↓SC ×{stacks}',
    'shop.softcapTooltipNext': 'Base production -{percent}%. Next reduction at {next}.',
    'shop.softcapTooltipMax': 'Base production -{percent}%. No further reductions.',
    'upgrades.title': 'Upgrades',
    'upgrades.cost': 'Cost',
    'upgrades.action.buy': 'Upgrade',
    'upgrades.status.owned': 'Purchased',
    'upgrades.status.ready': 'Unlocked',
    'upgrades.status.affordable': 'Ready to buy',
    'upgrades.status.locked': 'Locked',
    'upgrades.progress.active': 'Active',
    'upgrades.lock.items': 'Need {remaining}× {name}',
    'upgrades.lock.total': 'Need {amount} lifetime buds',
    'upgrades.lock.upgrade': 'Requires previous upgrade: {name}',
    'upgrades.requirement.items': '{current}/{required}× {name}',
    'upgrades.requirement.total': 'Lifetime buds {current} / {required}',
    'upgrades.requirement.upgrade': 'Requires upgrade: {name}',
    'upgrades.category.building': 'Building',
    'upgrades.category.synergy': 'Synergy',
    'upgrades.category.utility': 'Utility',
    'upgrades.toast.title': 'Upgrade',
    'upgrades.toast.message': '{name} leveled up!',
    'upgrades.fx.spark': 'Upgrade!',
    'achievements.title': 'Achievements',
    'achievements.reward': 'Bonus +{value}%',
    'achievements.status.locked': 'Locked',
    'achievements.status.unlocked': 'Unlocked',
    'abilities.title': 'Active Abilities',
    'abilities.status.ready': 'Ready',
    'abilities.status.active': 'Active ({seconds}s)',
    'abilities.status.cooldown': 'Cooldown ({seconds}s)',
    'abilities.overdrive.name': 'Overdrive',
    'abilities.overdrive.desc': 'Production x{multiplier} for {duration} s. Cooldown {cooldown} s.',
    'abilities.burst.name': 'Burst Click',
    'abilities.burst.desc': 'Click value x{multiplier} for {duration} s. Cooldown {cooldown} s.',
    'research.title': 'Research',
    'research.filter.all': 'All',
    'research.filter.available': 'Available',
    'research.filter.owned': 'Owned',
    'research.path.efficiency': 'Path A · Efficiency',
    'research.path.control': 'Path B · Control',
    'research.path.strain': 'Path C · Strains',
    'research.cost.buds': 'Cost (Buds)',
    'research.cost.seeds': 'Cost (Seeds)',
    'research.requires': 'Requires: {list}',
    'research.button.buy': 'Research',
    'research.button.owned': 'Completed',
    'research.button.locked': 'Locked',
    'research.empty': 'No research available.',
    'research.effect.bps': 'BPS x{value}',
    'research.effect.bpc': 'BPC x{value}',
    'research.effect.cost': 'Cost -{value}%',
    'research.effect.autoclick': 'Auto-click +{value}/s',
    'research.effect.overdrive': 'Overdrive +{value}%',
    'research.effect.offline': 'Offline cap +{value}h',
    'research.effect.abilityDuration': 'Skill duration +{value}%',
    'research.effect.hydroIrrigation': 'Hydro & Irrigation x{value}',
    'research.effect.hybridBuff': '+{percent}% per active buff',
    'research.effect.strain.indica': 'Specialisation: Indica',
    'research.effect.strain.sativa': 'Specialisation: Sativa',
    'research.effect.strain.hybrid': 'Specialisation: Hybrid',
    'research.confirm.strain': 'This strain choice lasts until your next prestige. Activate now?',
    'research.lock.exclusive': 'Another specialisation is active. Reset via prestige to swap.',
    'research.lock.totalBuds': 'Requires total buds ≥ {value}',
    'research.lock.prestigeSeeds': 'Requires seeds ≥ {value} (current {current})',
    'research.lock.all': 'Requires: {list}',
    'research.lock.any': 'Meet one of the following: {list}',
    'toast.offline.title': 'Offline Earnings',
    'toast.offline.body': '+{buds} buds for {duration}',
    'events.goldenBud.name': 'Golden Bud',
    'events.goldenBud.title': 'Golden Bud',
    'events.goldenBud.body': 'Instantly gained +{buds} buds!',
    'events.seedPack.name': 'Seed Pack',
    'events.seedPack.title': 'Seed Pack',
    'events.seedPack.body': 'Collected +{seeds} seeds!',
    'events.luckyJoint.name': 'Lucky Joint',
    'events.luckyJoint.title': 'Lucky Joint',
    'events.luckyJoint.body': 'Production x{multiplier} for {duration}s!',
    'events.luckyJoint.refresh': 'Boost refreshed! Production x{multiplier} for {duration}s.',
    'toggle.off': 'OFF',
  },
};

export function t(locale: LocaleKey, key: string, params: Record<string, string | number> = {}): string {
  const source = translations[locale]?.[key] ?? translations[DEFAULT_LOCALE]?.[key] ?? key;
  return Object.entries(params).reduce((acc, [token, value]) => acc.replaceAll(`{${token}}`, String(value)), source);
}

export function resolveLocale(candidate?: string | null): LocaleKey {
  if (!candidate) {
    return DEFAULT_LOCALE;
  }

  const normalized = candidate.toLowerCase().slice(0, 2) as LocaleKey;

  return SUPPORTED_LOCALES.includes(normalized) ? normalized : DEFAULT_LOCALE;
}








