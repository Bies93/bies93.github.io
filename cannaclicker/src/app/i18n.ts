export type LocaleKey = 'de' | 'en';

export const SUPPORTED_LOCALES: readonly LocaleKey[] = ['de', 'en'];
export const DEFAULT_LOCALE: LocaleKey = 'de';

const translations: Record<LocaleKey, Record<string, string>> = {
  de: {
    'app.title': 'CannaClicker',
    'stats.buds': 'Buds',
    'stats.bpc': 'Buds pro Klick',
    'stats.bps': 'Buds pro Sekunde',
    'stats.total': 'Gesamt geerntet',
    'stats.seeds': 'Seeds',
    'stats.prestigeMult': 'Prestige-Multiplikator',
    'actions.click': 'Ernte Buds',
    'actions.buy': 'Kaufen',
    'actions.max': 'Max',
    'actions.export': 'Export',
    'actions.import': 'Import',
    'actions.reset': 'Reset',
    'actions.close': 'Schließen',
    'actions.mute': 'Stumm',
    'actions.unmute': 'Ton',
    'actions.prestige': 'Prestige',
    'actions.confirm': 'Bestätigen',
    'actions.cancel': 'Abbrechen',
    'modal.import.title': 'Spielstand importieren',
    'modal.import.hint': 'Füge hier deinen Base64-Export ein.',
    'modal.reset.title': 'Fortschritt zurücksetzen?',
    'modal.reset.body': 'Das löscht deinen aktuellen Fortschritt unwiderruflich.',
    'modal.reset.confirm': 'Ja, löschen',
    'shop.title': 'Anbau',
    'shop.empty': 'Noch keine Gebaeude verfuegbar. Ernte mehr Buds!',
    'shop.cost': 'Kosten',
    'shop.nextPrice': 'Naechster Preis',
    'shop.owned': 'Besitzt',
    'shop.paybackLabel': 'Amortisation',
    'shop.paybackValue': '{seconds}s',
    'shop.sort.label': 'Sortierung',
    'shop.sort.price': 'Preis',
    'shop.sort.bps': 'BPS',
    'shop.sort.roi': 'ROI',
    'shop.roiValue': 'ROI {seconds}s',
    'shop.roiInfinite': 'ROI ∞',
    'shop.stageLabel': 'Stufe {level}',
    'shop.stageProgress': 'noch {remaining} bis Stufe {next}',
    'shop.stageTooltip': 'Stufenbonus ×{bonus} je {count} Käufe',
    'shop.autobuy.title': 'Auto-Buy',
    'shop.autobuy.enable': 'Auto-Buy aktivieren',
    'shop.autobuy.roiLabel': 'ROI-Ziel',
    'shop.autobuy.roiValue': 'ROI < {seconds}s',
    'shop.autobuy.reserveLabel': 'Reserve',
    'shop.autobuy.reserveValue': '{percent}% Reserve',
    'upgrades.title': 'Upgrades',
    'achievements.title': 'Erfolge',
    'abilities.title': 'Aktive Faehigkeiten',
    'abilities.status.ready': 'Bereit',
    'abilities.status.active': 'Aktiv ({seconds}s)',
    'abilities.status.cooldown': 'Abklingzeit ({seconds}s)',
    'abilities.overdrive.name': 'Overdrive',
    'abilities.overdrive.desc': 'Produktion x{multiplier} fuer {duration} s. Abklingzeit {cooldown} s.',
    'abilities.burst.name': 'Burst Click',
    'abilities.burst.desc': 'Klickwert x{multiplier} fuer {duration} s. Abklingzeit {cooldown} s.',
    'research.title': 'Forschung',
    'research.filter.all': 'Alle',
    'research.filter.available': 'Verfuegbar',
    'research.filter.owned': 'Gekauft',
    'research.cost.buds': 'Kosten (Buds)',
    'research.cost.seeds': 'Kosten (Seeds)',
    'research.requires': 'Benoetigt: {list}',
    'research.button.buy': 'Erforschen',
    'research.button.owned': 'Abgeschlossen',
    'research.button.locked': 'Gesperrt',
    'research.empty': 'Keine Forschung verfuegbar.',
    'research.effect.bps': 'BPS x{value}',
    'research.effect.bpc': 'BPC x{value}',
    'research.effect.cost': 'Kosten -{value}%',
    'research.effect.autoclick': 'Auto-Klick +{value}/s',
    'research.effect.overdrive': 'Overdrive +{value}%',
    'prestige.modal.title': 'Prestige starten?',
    'prestige.modal.description': 'Soft-Reset loescht Buds, Gebaeude und Upgrades, Seeds bleiben erhalten.',
    'prestige.modal.warning': 'Setzt Buds, Items und Faehigkeiten zurueck. Seeds bleiben erhalten.',
    'prestige.modal.currentSeeds': 'Aktuelle Seeds',
    'prestige.modal.afterSeeds': 'Seeds nach Prestige',
    'prestige.modal.gainSeeds': 'Neue Seeds',
    'prestige.modal.globalBonus': 'Globaler Bonus',
    'prestige.modal.requirement': 'Benoetigt {value} Lifetime-Buds',
    'prestige.modal.tooSoon': 'Zu wenige Buds fuer neue Seeds',
    'prestige.modal.checkbox': 'Ich verstehe den Soft-Reset',
    'prestige.modal.confirm': 'Prestige ausloesen',
    'prestige.badge.tooltip': 'Globaler Bonus: +{value}%',
    'prestige.control.locked': 'Prestige ab {requirement} Lifetime-Buds',
    'toast.offline.title': 'Offline-Ertrag',
    'toast.offline.body': '+{buds} Buds fuer {duration}',
    'toggle.on': 'AN',
    'toggle.off': 'AUS',
  },
  en: {
    'app.title': 'CannaClicker',
    'stats.buds': 'Buds',
    'stats.bpc': 'Buds per Click',
    'stats.bps': 'Buds per Second',
    'stats.total': 'Total Harvested',
    'stats.seeds': 'Seeds',
    'stats.prestigeMult': 'Prestige Multiplier',
    'actions.click': 'Harvest Buds',
    'actions.buy': 'Buy',
    'actions.max': 'Max',
    'actions.export': 'Export',
    'actions.import': 'Import',
    'actions.reset': 'Reset',
    'actions.close': 'Close',
    'actions.mute': 'Mute',
    'actions.unmute': 'Sound',
    'actions.prestige': 'Prestige',
    'actions.confirm': 'Confirm',
    'actions.cancel': 'Cancel',
    'modal.import.title': 'Import save',
    'modal.import.hint': 'Paste your Base64 save code here.',
    'modal.reset.title': 'Reset progress?',
    'modal.reset.body': 'This cannot be undone and clears your current game.',
    'modal.reset.confirm': 'Yes, delete it',
    'shop.title': 'Grow Ops',
    'shop.empty': 'No buildings unlocked yet. Harvest more buds!',
    'shop.cost': 'Cost',
    'shop.nextPrice': 'Next price',
    'shop.owned': 'Owned',
    'shop.paybackLabel': 'Payback',
    'shop.paybackValue': '{seconds}s',
    'shop.sort.label': 'Sort',
    'shop.sort.price': 'Price',
    'shop.sort.bps': 'BPS',
    'shop.sort.roi': 'ROI',
    'shop.roiValue': 'ROI {seconds}s',
    'shop.roiInfinite': 'ROI ∞',
    'shop.stageLabel': 'Stage {level}',
    'shop.stageProgress': '{remaining} until Stage {next}',
    'shop.stageTooltip': 'Tier bonus ×{bonus} per {count} purchases',
    'shop.autobuy.title': 'Auto-Buy',
    'shop.autobuy.enable': 'Enable auto-buy',
    'shop.autobuy.roiLabel': 'ROI target',
    'shop.autobuy.roiValue': 'ROI < {seconds}s',
    'shop.autobuy.reserveLabel': 'Reserve',
    'shop.autobuy.reserveValue': '{percent}% reserve',
    'upgrades.title': 'Upgrades',
    'achievements.title': 'Achievements',
    'abilities.title': 'Active Abilities',
    'abilities.status.ready': 'Ready',
    'abilities.status.active': 'Active ({seconds}s)',
    'abilities.status.cooldown': 'Cooldown ({seconds}s)',
    'abilities.overdrive.name': 'Overdrive',
    'abilities.overdrive.desc': 'Production x{multiplier} for {duration} s. Cooldown {cooldown} s.',
    'abilities.burst.name': 'Burst Click',
    'abilities.burst.desc': 'Click value x{multiplier} for {duration} s. Cooldown {cooldown} s.',
    'research.title': 'Research',
    'research.filter.all': 'All',
    'research.filter.available': 'Available',
    'research.filter.owned': 'Owned',
    'research.cost.buds': 'Cost (Buds)',
    'research.cost.seeds': 'Cost (Seeds)',
    'research.requires': 'Requires: {list}',
    'research.button.buy': 'Research',
    'research.button.owned': 'Completed',
    'research.button.locked': 'Locked',
    'research.empty': 'No research available.',
    'research.effect.bps': 'BPS x{value}',
    'research.effect.bpc': 'BPC x{value}',
    'research.effect.cost': 'Cost -{value}%',
    'research.effect.autoclick': 'Auto-click +{value}/s',
    'research.effect.overdrive': 'Overdrive +{value}%',
    'toast.offline.title': 'Offline Earnings',
    'toast.offline.body': '+{buds} buds for {duration}',
    'toggle.off': 'OFF',
  },
};

export function t(locale: LocaleKey, key: string, params: Record<string, string | number> = {}): string {
  const source = translations[locale]?.[key] ?? translations[DEFAULT_LOCALE]?.[key] ?? key;
  return Object.entries(params).reduce((acc, [token, value]) => acc.replaceAll(`{${token}}`, String(value)), source);
}

export function resolveLocale(candidate?: string | null): LocaleKey {
  if (!candidate) {
    return DEFAULT_LOCALE;
  }

  const normalized = candidate.toLowerCase().slice(0, 2) as LocaleKey;

  return SUPPORTED_LOCALES.includes(normalized) ? normalized : DEFAULT_LOCALE;
}














